<div class="container">
    <div class="page-header">KG Question Answerer</div>

    <div class=" chat-container">
        @if (errorLLMAnswer) {
        <div class="error-message">Error: {{ errorLLMAnswer | json }}</div>
        }

        @for (item of chat_messages; track $index) {
        @if(item.sender == "user") {
        <mat-expansion-panel class="message user-message" expanded="true">
            <mat-expansion-panel-header>
                <mat-panel-title> <mat-icon>person_pin</mat-icon> ➡️ {{item.sender}}</mat-panel-title>
            </mat-expansion-panel-header>

            <markdown lineNumbers data="*{{item.content}}*"></markdown>

        </mat-expansion-panel>
        }@else {
        <mat-expansion-panel class="message system-message" expanded="true">
            <mat-expansion-panel-header>
                <mat-panel-title> <mat-icon>memory</mat-icon> ➡️ {{item.sender}}</mat-panel-title>
            </mat-expansion-panel-header>

            <markdown lineNumbers [data]="item.content" clipboard></markdown>

        </mat-expansion-panel>
        }
        }

    </div>

    <div class=" question-container">
        <mat-form-field class="question-input">
            <mat-label>Question to answer</mat-label>
            <input matInput placeholder="Ex. {{model.question}}" [formControl]="question_fc">
            @if (question_fc.hasError('required')) {
            <mat-error>The question is <strong>required</strong></mat-error>
            }
        </mat-form-field>

        <button mat-mini-fab (click)="setConfiguration()">
            <mat-icon>settings</mat-icon>
        </button>

        @if(!workflowRunning) {
        <button mat-mini-fab (click)="ask_question()" [disabled]="!this.currentConfig || question_fc.invalid">
            <mat-icon>send</mat-icon>
        </button>
        }@else {
        <button mat-mini-fab (click)="stop_wrkflow()" disabled="true">
            <mat-icon>stop</mat-icon>
        </button>
        }
    </div>

</div>